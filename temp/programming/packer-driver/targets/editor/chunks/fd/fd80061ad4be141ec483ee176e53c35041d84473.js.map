{"version":3,"sources":["file:///Users/wangyifeng1/AircraftBattle/assets/script/BgController.ts"],"names":["_decorator","Component","Contact2DType","PhysicsSystem2D","EnemyController","BulletController","GameController","GameState","ccclass","property","BgController","type","start","instance","on","BEGIN_CONTACT","onBeginContact","update","deltaTime","item","node","children","x","y","getPosition","moveY","console","log","setPosition","self","other","tag","getComponent","die","gameCtrl","setCurState","GS_OVER"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAwBC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,a,OAAAA,a;AAAqBC,MAAAA,e,OAAAA,e;;AACxDC,MAAAA,e,iBAAAA,e;;AACAC,MAAAA,gB,iBAAAA,gB;;AACAC,MAAAA,c,iBAAAA,c;AAAgBC,MAAAA,S,iBAAAA,S;;;;;;;;;OACnB;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBT,U;;8BAGjBU,Y,WADZF,OAAO,CAAC,cAAD,C,UAEHC,QAAQ,CAAC;AAAEE,QAAAA,IAAI;AAAA;AAAA;AAAN,OAAD,C,2BAFb,MACaD,YADb,SACkCT,SADlC,CAC4C;AAAA;AAAA;;AAAA;AAAA;;AAIxCW,QAAAA,KAAK,GAAG;AACJT,UAAAA,eAAe,CAACU,QAAhB,CAAyBC,EAAzB,CAA4BZ,aAAa,CAACa,aAA1C,EAAyD,KAAKC,cAA9D,EAA8E,IAA9E;AACH;;AAEDC,QAAAA,MAAM,CAACC,SAAD,EAAoB;AACtB,eAAK,IAAIC,IAAT,IAAiB,KAAKC,IAAL,CAAUC,QAA3B,EAAqC;AACjC,kBAAM;AAAEC,cAAAA,CAAF;AAAKC,cAAAA;AAAL,gBAAWJ,IAAI,CAACK,WAAL,EAAjB;AAEA,kBAAMC,KAAK,GAAGF,CAAC,GAAG,MAAML,SAAxB;AACAQ,YAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBF,KAAtB;AAEAN,YAAAA,IAAI,CAACS,WAAL,CAAiBN,CAAjB,EAAoBG,KAApB,EANiC,CASjC;;AACA,gBAAIA,KAAK,GAAG,CAAC,GAAb,EAAkB;AACdN,cAAAA,IAAI,CAACS,WAAL,CAAiBN,CAAjB,EAAoBG,KAAK,GAAG,MAAM,CAAlC;AACH;AACJ;AACJ,SAvBuC,CAyBxC;;;AACAT,QAAAA,cAAc,CAACa,IAAD,EAAmBC,KAAnB,EAAsC;AAEhD;AACA,cAAIA,KAAK,CAACC,GAAN,KAAc,CAAd,IAAmBF,IAAI,CAACE,GAAL,KAAa,CAApC,EAAuC;AACnCD,YAAAA,KAAK,CAACE,YAAN;AAAA;AAAA,oDAAoCC,GAApC;AACAJ,YAAAA,IAAI,CAACG,YAAL;AAAA;AAAA,sDAAoCC,GAApC;AACH,WAHD,MAGO,IAAIH,KAAK,CAACC,GAAN,KAAc,CAAd,IAAmBF,IAAI,CAACE,GAAL,KAAa,CAApC,EAAuC;AAC1CD,YAAAA,KAAK,CAACE,YAAN;AAAA;AAAA,sDAAqCC,GAArC;AACAJ,YAAAA,IAAI,CAACG,YAAL;AAAA;AAAA,oDAAmCC,GAAnC;AACH,WAT+C,CAWhD;;;AACA,cAAIH,KAAK,CAACC,GAAN,KAAc,CAAd,IAAmBF,IAAI,CAACE,GAAL,KAAa,CAApC,EAAuC;AACnC,gBAAI,KAAKG,QAAT,EAAmB;AACf,mBAAKA,QAAL,CAAcC,WAAd,CAA0B;AAAA;AAAA,0CAAUC,OAApC;AACH;AAEJ,WALD,MAKO,IAAIN,KAAK,CAACC,GAAN,KAAc,CAAd,IAAmBF,IAAI,CAACE,GAAL,KAAa,CAApC,EAAuC;AAC1C,gBAAI,KAAKG,QAAT,EAAmB;AACf,mBAAKA,QAAL,CAAcC,WAAd,CAA0B;AAAA;AAAA,0CAAUC,OAApC;AACH;AACJ;AACJ;;AAhDuC,O;;;;;iBAEC,I","sourcesContent":["import { _decorator, Collider2D, Component, Contact2DType, Node, PhysicsSystem2D } from 'cc';\nimport { EnemyController } from './EnemyController';\nimport { BulletController } from './BulletController';\nimport { GameController, GameState } from './GameController';\nconst { ccclass, property } = _decorator;\n\n@ccclass('BgController')\nexport class BgController extends Component {\n    @property({ type: GameController })\n    public gameCtrl: GameController | null = null;\n\n    start() {\n        PhysicsSystem2D.instance.on(Contact2DType.BEGIN_CONTACT, this.onBeginContact, this);\n    }\n\n    update(deltaTime: number) {\n        for (let item of this.node.children) {\n            const { x, y } = item.getPosition();\n\n            const moveY = y - 100 * deltaTime;\n            console.log('moveY:', moveY)\n\n            item.setPosition(x, moveY);\n\n\n            //超出屏幕，回到顶部\n            if (moveY < -870) {\n                item.setPosition(x, moveY + 852 * 2)\n            }\n        }\n    }\n\n    //两个碰撞体开始接触被调用1次\n    onBeginContact(self: Collider2D, other: Collider2D) {\n\n        //当tag等于1/0的时候，说明是子弹和敌机相撞，销毁对应的对象\n        if (other.tag === 1 && self.tag === 0) {\n            other.getComponent(EnemyController).die();\n            self.getComponent(BulletController).die();\n        } else if (other.tag === 0 && self.tag === 1) {\n            other.getComponent(BulletController).die();\n            self.getComponent(EnemyController).die();\n        }\n\n        //飞机撞到其他飞机\n        if (other.tag === 1 && self.tag === 2) {\n            if (this.gameCtrl) {\n                this.gameCtrl.setCurState(GameState.GS_OVER);\n            }\n\n        } else if (other.tag === 2 && self.tag === 1) {\n            if (this.gameCtrl) {\n                this.gameCtrl.setCurState(GameState.GS_OVER);\n            }\n        }\n    }\n}\n\n"]}