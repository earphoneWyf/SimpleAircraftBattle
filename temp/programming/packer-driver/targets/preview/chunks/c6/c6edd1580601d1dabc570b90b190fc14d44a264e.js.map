{"version":3,"sources":["file:///Users/wangyifeng1/AircraftBattle/assets/script/EnemyController.ts"],"names":["_decorator","Component","resources","Sprite","SpriteFrame","ccclass","property","EnemyController","isDead","airplaneDeadImages","start","loadImages","update","deltaTime","x","y","node","getPosition","moveY","setPosition","destroy","loadDir","_err","spriteFrames","playDead","setTimeout","getComponent","spriteFrame","i","length","die"],"mappings":";;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAiBC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,W,OAAAA,W;;;;;;;;;OACnD;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBN,U;;iCAGjBO,e,WADZF,OAAO,CAAC,iBAAD,C,gBAAR,MACaE,eADb,SACqCN,SADrC,CAC+C;AAAA;AAAA;AAAA,eAC3CO,MAD2C,GACzB,KADyB;AAAA,eAE3CC,kBAF2C,GAEtB,EAFsB;AAAA;;AAI3CC,QAAAA,KAAK,GAAG;AACJ,eAAKC,UAAL;AACH;;AAEDC,QAAAA,MAAM,CAACC,SAAD,EAAoB;AACtB,cAAI,KAAKL,MAAT,EAAiB;AACjB,cAAM;AAAEM,YAAAA,CAAF;AAAKC,YAAAA;AAAL,cAAW,KAAKC,IAAL,CAAUC,WAAV,EAAjB;AACA,cAAMC,KAAK,GAAGH,CAAC,GAAG,MAAMF,SAAxB;AACA,eAAKG,IAAL,CAAUG,WAAV,CAAsBL,CAAtB,EAAyBI,KAAzB;;AAEA,cAAIA,KAAK,GAAG,CAAC,GAAb,EAAkB;AACd,iBAAKF,IAAL,CAAUI,OAAV;AACH;AACJ,SAjB0C,CAoB3C;;;AACAT,QAAAA,UAAU,GAAG;AACTT,UAAAA,SAAS,CAACmB,OAAV,CAAkB,sBAAlB,EAA0CjB,WAA1C,EAAuD,CAACkB,IAAD,EAAOC,YAAP,KAAwB;AAC3E,iBAAKd,kBAAL,GAA0Bc,YAA1B;AACH,WAFD;AAGH,SAzB0C,CA2B3C;;;AACAC,QAAAA,QAAQ,GAAG;AAAA;;AAAA,wCACkD;AACrDC,YAAAA,UAAU,CAAC,MAAM;AACb,kBAAI,KAAI,CAACT,IAAL,CAAUU,YAAd,EAA4B;AACxB,gBAAA,KAAI,CAACV,IAAL,CAAUU,YAAV,CAAuBvB,MAAvB,EAA+BwB,WAA/B,GAA6C,KAAI,CAAClB,kBAAL,CAAwBmB,CAAxB,CAA7C;AACH;AACJ,aAJS,EAIPA,CAAC,GAAG,EAJG,CAAV;AAKH,WAPM;;AACP,eAAK,IAAIA,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKnB,kBAAL,CAAwBoB,MAA5C,EAAoDD,CAAC,EAArD;AAAA;AAAA;AAOH,SApC0C,CAsC3C;;;AACAE,QAAAA,GAAG,GAAG;AACF,cAAI,KAAKtB,MAAT,EAAiB;AACjB,eAAKA,MAAL,GAAc,IAAd;AACA,eAAKgB,QAAL;AAEAC,UAAAA,UAAU,CAAC,MAAM;AACb,iBAAKT,IAAL,CAAUI,OAAV;AACH,WAFS,EAEP,GAFO,CAAV;AAGH;;AA/C0C,O","sourcesContent":["import { _decorator, Component, Node, resources, Sprite, SpriteFrame } from 'cc';\nconst { ccclass, property } = _decorator;\n\n@ccclass('EnemyController')\nexport class EnemyController extends Component {\n    isDead: boolean = false;\n    airplaneDeadImages = [];\n\n    start() {\n        this.loadImages();\n    }\n\n    update(deltaTime: number) {\n        if (this.isDead) return;\n        const { x, y } = this.node.getPosition();\n        const moveY = y - 500 * deltaTime;\n        this.node.setPosition(x, moveY);\n\n        if (moveY < -900) {\n            this.node.destroy();\n        }\n    }\n\n\n    //加载图片\n    loadImages() {\n        resources.loadDir('airplane/enemy-death', SpriteFrame, (_err, spriteFrames) => {\n            this.airplaneDeadImages = spriteFrames;\n        })\n    }\n\n    //播放死亡动画\n    playDead() {\n        for (let i = 0; i < this.airplaneDeadImages.length; i++) {\n            setTimeout(() => {\n                if (this.node.getComponent) {\n                    this.node.getComponent(Sprite).spriteFrame = this.airplaneDeadImages[i];\n                }\n            }, i * 80)\n        }\n    }\n\n    //敌机销毁调用\n    die() {\n        if (this.isDead) return;\n        this.isDead = true;\n        this.playDead();\n\n        setTimeout(() => {\n            this.node.destroy();\n        }, 300)\n    }\n}\n\n"]}